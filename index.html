<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>Mini FNF HTML</title>

<style>
body {
  margin: 0;
  background: #111;
  color: white;
  font-family: Arial, sans-serif;
  display: flex;
  justify-content: center;
  align-items: center;
  height: 100vh;
}

canvas {
  background: #000;
  border: 3px solid white;
  display: none;
}

.menu {
  text-align: center;
}

button {
  background: #ff2f92;
  border: none;
  color: white;
  font-size: 20px;
  padding: 10px 25px;
  margin: 10px;
  cursor: pointer;
}

button:hover {
  background: #ff5ab0;
}
</style>
</head>

<body>

<!-- MENÃš -->
<div id="menu" class="menu">
  <h1>ðŸŽ¤ MINI FNF</h1>
  <button onclick="openWeek()">SEMANA 1</button>
</div>

<!-- JUEGO -->
<canvas id="game" width="400" height="600"></canvas>

<script>
const canvas = document.getElementById("game");
const ctx = canvas.getContext("2d");
const menu = document.getElementById("menu");

const keys = ["ArrowLeft", "ArrowUp", "ArrowDown", "ArrowRight"];
const laneX = [50, 130, 210, 290];

let notes = [];
let score = 0;
let gameRunning = false;

const hitLineY = 500;

// ----- SEMANA 1 (chart simple) -----
const week1 = [
  { time: 0, dir: 0 },
  { time: 600, dir: 1 },
  { time: 1200, dir: 2 },
  { time: 1800, dir: 3 },
  { time: 2400, dir: 0 },
  { time: 3000, dir: 1 },
  { time: 3600, dir: 2 }
];

let chartIndex = 0;
let startTime = 0;

// Abrir semana
function openWeek() {
  menu.style.display = "none";
  canvas.style.display = "block";
  startGame();
}

// Volver al menÃº
function backToMenu() {
  gameRunning = false;
  canvas.style.display = "none";
  menu.style.display = "block";
}

// Iniciar juego
function startGame() {
  notes = [];
  score = 0;
  chartIndex = 0;
  startTime = performance.now();
  gameRunning = true;
  requestAnimationFrame(update);
}

// Input
window.addEventListener("keydown", (e) => {
  if (!gameRunning) return;

  // Salir al menÃº
  if (e.key === "Escape") {
    backToMenu();
    return;
  }

  for (let i = 0; i < notes.length; i++) {
    const note = notes[i];
    if (
      e.key === keys[note.dir] &&
      Math.abs(note.y - hitLineY) < 30
    ) {
      notes.splice(i, 1);
      score += 100;
      break;
    }
  }
});

// Loop principal
function update(now) {
  if (!gameRunning) return;

  ctx.clearRect(0, 0, canvas.width, canvas.height);

  const currentTime = now - startTime;

  // Spawn notas segÃºn la semana
  if (
    chartIndex < week1.length &&
    currentTime >= week1[chartIndex].time
  ) {
    const dir = week1[chartIndex].dir;
    notes.push({
      dir: dir,
      x: laneX[dir],
      y: -20
    });
    chartIndex++;
  }

  // LÃ­nea de golpeo
  ctx.strokeStyle = "white";
  ctx.beginPath();
  ctx.moveTo(0, hitLineY);
  ctx.lineTo(canvas.width, hitLineY);
  ctx.stroke();

  // Flechas fijas
  ctx.fillStyle = "gray";
  laneX.forEach(x => {
    ctx.fillRect(x, hitLineY + 10, 40, 20);
  });

  // Notas
  ctx.fillStyle = "cyan";
  for (let i = notes.length - 1; i >= 0; i--) {
    const note = notes[i];
    note.y += 3;
    ctx.fillRect(note.x, note.y, 40, 20);

    if (note.y > canvas.height) {
      notes.splice(i, 1);
    }
  }

  // UI
  ctx.fillStyle = "white";
  ctx.font = "16px Arial";
  ctx.fillText("Semana 1", 10, 20);
  ctx.fillText("Score: " + score, 10, 40);
  ctx.fillText("ESC = MenÃº", 260, 20);

  requestAnimationFrame(update);
}
</script>
</body>
</html>
